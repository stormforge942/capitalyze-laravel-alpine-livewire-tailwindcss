<div x-data="{
    open: false,
    search: '',
    loadingSuggestions: false,
    history: @entangle('history').defer,
    suggestions: @entangle('suggestions').defer,
    checklist: @entangle('checklist').defer,

    init() {
        this.$watch('search', value => {
            this.loadingSuggestions = true;
            this.$wire.getSuggestions(value)
                .then(() => this.loadingSuggestions = false);
        });
    },

    navigateTo(item) {
        this.$wire.navigateTo(item)
            .then(() => window.location.href = item.href);
    }
}" class="h-14 w-full lg:w-2/3 relative" @keydown.window.escape="open = false" @click.away="open = false">
    <div class="rounded-lg border border-green-muted bg-white leading-[3rem] px-3 flex items-center focus-within:border-green-dark">
        <svg width="25" height="24" viewBox="0 0 25 24" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
                d="M16.3645 14.3208H15.5515L15.2633 14.0429C16.2719 12.8696 16.8791 11.3465 16.8791 9.68954C16.8791 5.99485 13.8842 3 10.1895 3C6.49485 3 3.5 5.99485 3.5 9.68954C3.5 13.3842 6.49485 16.3791 10.1895 16.3791C11.8465 16.3791 13.3696 15.7719 14.5429 14.7633L14.8208 15.0515V15.8645L19.9666 21L21.5 19.4666L16.3645 14.3208ZM10.1895 14.3208C7.62693 14.3208 5.55832 12.2521 5.55832 9.68954C5.55832 7.12693 7.62693 5.05832 10.1895 5.05832C12.7521 5.05832 14.8208 7.12693 14.8208 9.68954C14.8208 12.2521 12.7521 14.3208 10.1895 14.3208Z"
                fill="#9DA3A8" />
        </svg>

        <input placeholder="Search" @focus="open = true;" x-model.debounce.500ms="search" class="w-full text-left text-[#7C8286] ml-3 focus:outline-none" />
    </div>

    <template x-if="open">
        <div class="absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-semibold" x-text="'Discover' + (search ? ` “${search}“` : '')">Discover</h3>

            <template x-if="! checklist">
                <div class="flex flex-row gap-x-3 items-center my-3">
                    <div class="flex flex-row gap-x-2 items-center">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7.0026 13.6667C3.3207 13.6667 0.335938 10.6819 0.335938 7.00001C0.335938 3.31811 3.3207 0.333344 7.0026 0.333344C10.6845 0.333344 13.6693 3.31811 13.6693 7.00001C13.6693 10.6819 10.6845 13.6667 7.0026 13.6667ZM7.0026 12.3333C9.94814 12.3333 12.3359 9.94554 12.3359 7.00001C12.3359 4.05449 9.94814 1.66668 7.0026 1.66668C4.05708 1.66668 1.66927 4.05449 1.66927 7.00001C1.66927 9.94554 4.05708 12.3333 7.0026 12.3333ZM6.33594 9.00001H7.66927V10.3333H6.33594V9.00001ZM6.33594 3.66668H7.66927V7.66668H6.33594V3.66668Z" fill="#121A0F"/>
                        </svg>
                        <div>You have not created a checklist.</div>
                    </div>

                    <button type="button" class="h-[50px] lg:h-auto bg-dark text-green-dark font-medium text-sm flex items-center gap-x-2 px-4 py-2 rounded hover:bg-opacity-80 transition-all" @click="checklist=true;">
                        <span class="hidden sm:inline">Create CheckList</span>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="12" fill="white"/>
                            <path d="M14.4141 4H19.0043V8.36009L14.4141 4Z" fill="#52D3A2"/>
                            <path d="M16.2798 14.5161C16.0109 15.5196 15.4955 16.3068 14.7301 16.8756C13.9647 17.4454 13.0149 17.7303 11.8795 17.7303C10.8542 17.7303 9.95548 17.4865 9.1823 17.0001C8.40912 16.5136 7.81813 15.8351 7.40821 14.9667C6.99829 14.0983 6.79278 13.1095 6.79278 12.0005C6.79278 10.8767 6.99829 9.88485 7.40821 9.02275C7.81813 8.16171 8.41023 7.48744 9.1823 6.99993C9.9277 6.53037 10.792 6.28978 11.7718 6.2729V6.27079H11.8484C11.8584 6.27079 11.8684 6.26974 11.8795 6.26974C11.8895 6.26974 11.8984 6.27079 11.9084 6.27079H12.2895V4.00633C12.1928 4.00317 12.0962 4 11.9984 4C10.3898 4 8.98234 4.33344 7.7748 5.00033C6.56838 5.66616 5.63745 6.60212 4.98203 7.80822C4.32771 9.01431 4 10.4114 4 11.9995C4 13.6023 4.32771 15.0078 4.98203 16.2129C5.63634 17.419 6.56727 18.3518 7.77369 19.0113C8.98012 19.6708 10.3876 20 11.9973 20C13.2593 20 14.3868 19.7752 15.3799 19.3257C16.3731 18.8762 17.1818 18.2399 17.805 17.4158C18.4282 16.5917 18.8259 15.6251 18.9992 14.5172H16.2798V14.5161Z" fill="#121A0F"/>
                        </svg>
                    </button>
                </div>
            </template>

            <template x-if="checklist">
                <div class="flex flex-row gap-x-3 items-center my-3">
                    <div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input
                                class="sr-only peer checked"
                                type="checkbox"
                                x-model="checklist">
                            <div
                                class="w-10 h-3 mt-1.5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-100 dark:peer-focus:ring-green-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[0px] after:bg-white peer-checked:after:bg-green-600 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[#13B05B40]"></div>
                        </label>
                    </div>
                    <div>Show checklist results</div>
                    <x-select placeholder="Earnings Quality" :options="['earnings-quality' => 'Earnings Quality']"></x-select>
                </div>
            </template>

            <div x-show="! search">
                <div x-show="! Object.keys(history).length" class="flex align-item-center justify-center h-[200px]">
                    <div>
                        <svg class="m-auto mt-6" width="66" height="64" viewBox="0 0 66 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_17086_140210)">
                                <path d="M41.7654 14.3923H24.2507C23.8516 14.3928 23.4689 14.5529 23.1867 14.8376C22.9045 15.1223 22.7457 15.5083 22.7452 15.9109V55.176L22.5445 55.2378L18.2479 56.565C18.0442 56.6276 17.8243 56.6062 17.6363 56.5054C17.4483 56.4046 17.3077 56.2327 17.2452 56.0274L4.46472 13.9175C4.40253 13.7121 4.42373 13.4902 4.52366 13.3005C4.62359 13.1109 4.79409 12.969 4.99767 12.9061L11.6188 10.8611L30.8136 4.93464L37.4346 2.88963C37.5354 2.85835 37.6413 2.84742 37.7462 2.85747C37.8512 2.86751 37.9531 2.89834 38.0463 2.94817C38.1394 2.99801 38.2219 3.06588 38.289 3.14791C38.3561 3.22993 38.4065 3.3245 38.4373 3.4262L41.7041 14.1898L41.7654 14.3923Z" fill="#F5F5F5"/>
                                <path d="M45.586 14.1901L41.6487 1.21746C41.5832 1.00131 41.4761 0.800298 41.3335 0.625914C41.191 0.451529 41.0158 0.307187 40.8179 0.201136C40.62 0.095085 40.4033 0.0294022 40.1803 0.00784372C39.9572 -0.0137148 39.7322 0.00927339 39.5179 0.0754922L30.2091 2.94964L11.0153 8.87712L1.70645 11.7523C1.27401 11.8862 0.911922 12.1878 0.699664 12.5907C0.487407 12.9937 0.44232 13.4651 0.574303 13.9016L14.0312 58.2367C14.1385 58.589 14.3548 58.8974 14.6485 59.1166C14.9422 59.3358 15.2979 59.4542 15.6632 59.4546C15.8323 59.4547 16.0004 59.4291 16.162 59.3787L22.5432 57.4086L22.7439 57.3458V57.1342L22.5432 57.196L16.1028 59.1853C15.7211 59.3027 15.3088 59.2625 14.9564 59.0737C14.604 58.8849 14.3402 58.5627 14.223 58.178L0.767045 13.8418C0.708943 13.6512 0.688693 13.4509 0.707453 13.2523C0.726214 13.0538 0.783616 12.8609 0.876375 12.6848C0.969134 12.5086 1.09543 12.3527 1.24802 12.2259C1.40062 12.099 1.57652 12.0038 1.76565 11.9456L11.0745 9.07049L30.2683 3.14402L39.5772 0.268859C39.7206 0.224699 39.8698 0.202182 40.0197 0.202041C40.3416 0.20277 40.6548 0.307446 40.9135 0.500736C41.1721 0.694026 41.3626 0.965774 41.457 1.27618L45.3762 14.1901L45.4385 14.3926H45.6472L45.586 14.1901Z" fill="#464E49"/>
                                <path d="M12.8138 12.9392C12.6204 12.939 12.432 12.8763 12.2765 12.7603C12.121 12.6443 12.0064 12.4811 11.9495 12.2946L10.6568 8.03534C10.622 7.92093 10.61 7.80074 10.6213 7.68163C10.6326 7.56252 10.6671 7.44682 10.7227 7.34115C10.7784 7.23548 10.8541 7.1419 10.9457 7.06576C11.0372 6.98962 11.1426 6.93242 11.2561 6.8974L28.9142 1.44434C29.1433 1.37383 29.3907 1.39788 29.6022 1.51121C29.8137 1.62453 29.972 1.81788 30.0424 2.04881L31.3351 6.30812C31.405 6.53918 31.3811 6.78876 31.2688 7.0021C31.1564 7.21544 30.9648 7.37512 30.7359 7.4461L13.0777 12.8992C12.9922 12.9256 12.9032 12.9391 12.8138 12.9392Z" fill="#52D3A2"/>
                                <path d="M19.5854 4.55162C20.694 4.55162 21.5927 3.64511 21.5927 2.52687C21.5927 1.40862 20.694 0.502106 19.5854 0.502106C18.4768 0.502106 17.5781 1.40862 17.5781 2.52687C17.5781 3.64511 18.4768 4.55162 19.5854 4.55162Z" fill="#52D3A2"/>
                                <path d="M19.5836 3.8079C20.2856 3.8079 20.8547 3.23387 20.8547 2.52576C20.8547 1.81766 20.2856 1.24362 19.5836 1.24362C18.8816 1.24362 18.3125 1.81766 18.3125 2.52576C18.3125 3.23387 18.8816 3.8079 19.5836 3.8079Z" fill="white"/>
                                <path d="M60.9874 58.9364H27.064C26.8379 58.9362 26.621 58.8454 26.4611 58.6841C26.3012 58.5228 26.2112 58.304 26.2109 58.0759V17.0745C26.2112 16.8464 26.3012 16.6276 26.4611 16.4663C26.621 16.305 26.8379 16.2142 27.064 16.214H60.9874C61.2136 16.2143 61.4304 16.305 61.5904 16.4663C61.7503 16.6276 61.8403 16.8464 61.8405 17.0745V58.0759C61.8402 58.304 61.7503 58.5228 61.5903 58.6841C61.4304 58.8454 61.2136 58.9361 60.9874 58.9364Z" fill="#D4DDD7"/>
                                <path d="M45.3799 14.1885H24.2531C23.8008 14.1892 23.3672 14.3707 23.0473 14.6933C22.7275 15.016 22.5475 15.4533 22.5469 15.9096V57.1944L22.7476 57.1327V15.9096C22.7481 15.507 22.9069 15.121 23.1891 14.8363C23.4713 14.5517 23.854 14.3915 24.2531 14.391H45.4421L45.3799 14.1885ZM63.7969 14.1885H24.2531C23.8008 14.1892 23.3672 14.3707 23.0473 14.6933C22.7275 15.016 22.5475 15.4533 22.5469 15.9096V62.2766C22.5475 62.7328 22.7275 63.1702 23.0473 63.4928C23.3672 63.8154 23.8008 63.997 24.2531 63.9976H63.7969C64.2492 63.997 64.6828 63.8154 65.0027 63.4928C65.3225 63.1702 65.5025 62.7328 65.5031 62.2766V15.9096C65.5024 15.4533 65.3225 15.016 65.0027 14.6933C64.6828 14.3707 64.2492 14.1892 63.7969 14.1885ZM65.3024 62.2766C65.3019 62.6792 65.1431 63.0651 64.8609 63.3498C64.5787 63.6345 64.196 63.7946 63.7969 63.7951H24.2531C23.854 63.7946 23.4713 63.6345 23.1891 63.3498C22.9069 63.0651 22.7481 62.6792 22.7476 62.2766V15.9096C22.7481 15.507 22.9069 15.121 23.1891 14.8363C23.4713 14.5517 23.854 14.3915 24.2531 14.391H63.7969C64.196 14.3915 64.5787 14.5517 64.8609 14.8363C65.1431 15.121 65.3019 15.507 65.3024 15.9096V62.2766Z" fill="#464E49"/>
                                <path d="M53.2533 18.6454H34.7861C34.5466 18.6451 34.317 18.549 34.1477 18.3782C33.9783 18.2074 33.8831 17.9758 33.8828 17.7342V13.2798C33.8831 13.0382 33.9783 12.8066 34.1477 12.6358C34.317 12.465 34.5466 12.3689 34.7861 12.3686H53.2533C53.4927 12.3689 53.7223 12.465 53.8917 12.6358C54.061 12.8066 54.1563 13.0382 54.1565 13.2798V17.7342C54.1563 17.9758 54.061 18.2074 53.8917 18.3782C53.7223 18.549 53.4927 18.6451 53.2533 18.6454Z" fill="#52D3A2"/>
                                <path d="M44.0229 12.6703C45.1315 12.6703 46.0302 11.7638 46.0302 10.6456C46.0302 9.52733 45.1315 8.62082 44.0229 8.62082C42.9143 8.62082 42.0156 9.52733 42.0156 10.6456C42.0156 11.7638 42.9143 12.6703 44.0229 12.6703Z" fill="#52D3A2"/>
                                <path d="M44.0195 11.8797C44.6948 11.8797 45.2421 11.3275 45.2421 10.6464C45.2421 9.9653 44.6948 9.41315 44.0195 9.41315C43.3443 9.41315 42.7969 9.9653 42.7969 10.6464C42.7969 11.3275 43.3443 11.8797 44.0195 11.8797Z" fill="white"/>
                            </g>
                            <defs>
                                <clipPath id="clip0_17086_140210">
                                    <rect width="65" height="64" fill="white" transform="translate(0.5)"/>
                                </clipPath>
                            </defs>
                        </svg>

                        <p class="mt-1 text-md text-gray-medium2 text-center">Discover thousands of companies with <b>Capitalyze</b>.</p>
                        <p class="mt-1 text-md text-gray-medium2 text-center">Start your search now</p>
                    </div>
                </div>
                <div x-show="Object.keys(history).length">
                    <div class="flex justify-between">
                        <div class="text-dark-light2 text-[11px]">Recent Search</div>
                        <button class="text-red text-sm font-semibold" @click="$wire.clearHistory()">Clear History</button>
                    </div>

                    <template x-for="historyItem in history">
                        <div class="hover:cursor-pointer hover:bg-[#F3F4F3] px-4 py-2" @click="navigateTo(historyItem)">
                            <div class="flex items-center gap-x-5">
                                <svg class="block" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.0026 1.33334C11.6845 1.33334 14.6693 4.31811 14.6693 8.00001C14.6693 11.6819 11.6845 14.6667 8.0026 14.6667C4.3207 14.6667 1.33594 11.6819 1.33594 8.00001H2.66927C2.66927 10.9455 5.05708 13.3333 8.0026 13.3333C10.9481 13.3333 13.3359 10.9455 13.3359 8.00001C13.3359 5.05449 10.9481 2.66668 8.0026 2.66668C6.36003 2.66668 4.89089 3.40923 3.91255 4.57696L5.33594 6.00001H1.33594V2.00001L2.96698 3.631C4.18928 2.2234 5.992 1.33334 8.0026 1.33334ZM8.66927 4.66668L8.66914 7.72334L10.831 9.88561L9.8882 10.8284L7.3358 8.27534L7.33594 4.66668H8.66927Z" fill="black"/>
                                </svg>
                                <div>
                                    <div class="flex flex-row gap-x-2 items-center">
                                        <div class="text-md font-semibold" x-text="historyItem.name"></div>
                                        <div class="text-sm" :class="historyItem.passed ? 'text-green' : 'text-red'" x-text="historyItem.passed ? 'Passed' : `Didn't pass`"></div>
                                        <div>
                                            <svg x-show="historyItem.passed" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M6.67101 1.40252C5.73663 1.10005 4.72088 1.52078 4.27405 2.39538L3.73686 3.44683C3.67303 3.57176 3.57143 3.67337 3.44649 3.7372L2.39505 4.27438C1.52045 4.72122 1.09971 5.73697 1.40219 6.67134L1.76583 7.79468C1.80903 7.92814 1.80903 8.07188 1.76583 8.20534L1.40219 9.32868C1.09971 10.2631 1.52045 11.2788 2.39505 11.7257L3.44649 12.2628C3.57143 12.3267 3.67303 12.4283 3.73686 12.5532L4.27405 13.6047C4.72088 14.4793 5.73663 14.9 6.67101 14.5975L7.79434 14.2339C7.92781 14.1907 8.07154 14.1907 8.20501 14.2339L9.32834 14.5975C10.2627 14.9 11.2785 14.4793 11.7253 13.6047L12.2625 12.5532C12.3263 12.4283 12.4279 12.3267 12.5529 12.2628L13.6043 11.7257C14.4789 11.2788 14.8997 10.2631 14.5972 9.32868L14.2335 8.20534C14.1903 8.07188 14.1903 7.92814 14.2335 7.79468L14.5972 6.67134C14.8997 5.73697 14.4789 4.72122 13.6043 4.27438L12.5529 3.7372C12.4279 3.67337 12.3263 3.57176 12.2625 3.44683L11.7253 2.39538C11.2785 1.52078 10.2627 1.10005 9.32834 1.40252L8.20501 1.76616C8.07154 1.80936 7.92781 1.80937 7.79434 1.76616L6.67101 1.40252ZM4.50619 7.83821L5.449 6.89534L7.33461 8.78101L11.1059 5.00978L12.0487 5.95258L7.33461 10.6666L4.50619 7.83821Z" fill="#13B05B"/>
                                            </svg>
                                            <svg x-show="! historyItem.passed" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M8.0026 14.6667C4.3207 14.6667 1.33594 11.6819 1.33594 8.00001C1.33594 4.31811 4.3207 1.33334 8.0026 1.33334C11.6845 1.33334 14.6693 4.31811 14.6693 8.00001C14.6693 11.6819 11.6845 14.6667 8.0026 14.6667ZM8.0026 7.05721L6.11698 5.17158L5.17418 6.11439L7.0598 8.00001L5.17418 9.88561L6.11698 10.8284L8.0026 8.94281L9.8882 10.8284L10.831 9.88561L8.9454 8.00001L10.831 6.11439L9.8882 5.17158L8.0026 7.05721Z" fill="#C22929"/>
                                            </svg>
                                        </div>
                                    </div>
                                    <div class="mt-1 text-sm text-dark-light2" x-text="`NASDAQ: ${historyItem.ticker}`"></div>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
            <div x-show="search">
                <template x-if="loadingSuggestions">
                    <div class="flex justify-center items-center w-full mt-2 mb-5 h-[100px]">
                        <x-loader />
                    </div>
                </template>

                <template x-if="!loadingSuggestions">
                    <div>
                        <div class="text-blue text-[11px]">Suggestions</div>

                        <template x-for="suggestion in suggestions">
                            <div class="hover:cursor-pointer hover:bg-[#F3F4F3] px-4 py-2" @click="navigateTo(suggestion)">
                                <div class="flex items-center gap-x-5">
                                    <img x-bind:src="suggestion.logo" width="32" height="32" />
                                    <div>
                                        <div class="flex flex-row gap-x-2 items-center">
                                            <div class="text-md font-semibold" x-text="suggestion.name"></div>
                                            <div class="text-sm" :class="suggestion.passed ? 'text-green' : 'text-red'" x-text="suggestion.passed ? 'Passed' : `Didn't pass`"></div>
                                            <div>
                                                <svg x-show="suggestion.passed" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M6.67101 1.40252C5.73663 1.10005 4.72088 1.52078 4.27405 2.39538L3.73686 3.44683C3.67303 3.57176 3.57143 3.67337 3.44649 3.7372L2.39505 4.27438C1.52045 4.72122 1.09971 5.73697 1.40219 6.67134L1.76583 7.79468C1.80903 7.92814 1.80903 8.07188 1.76583 8.20534L1.40219 9.32868C1.09971 10.2631 1.52045 11.2788 2.39505 11.7257L3.44649 12.2628C3.57143 12.3267 3.67303 12.4283 3.73686 12.5532L4.27405 13.6047C4.72088 14.4793 5.73663 14.9 6.67101 14.5975L7.79434 14.2339C7.92781 14.1907 8.07154 14.1907 8.20501 14.2339L9.32834 14.5975C10.2627 14.9 11.2785 14.4793 11.7253 13.6047L12.2625 12.5532C12.3263 12.4283 12.4279 12.3267 12.5529 12.2628L13.6043 11.7257C14.4789 11.2788 14.8997 10.2631 14.5972 9.32868L14.2335 8.20534C14.1903 8.07188 14.1903 7.92814 14.2335 7.79468L14.5972 6.67134C14.8997 5.73697 14.4789 4.72122 13.6043 4.27438L12.5529 3.7372C12.4279 3.67337 12.3263 3.57176 12.2625 3.44683L11.7253 2.39538C11.2785 1.52078 10.2627 1.10005 9.32834 1.40252L8.20501 1.76616C8.07154 1.80936 7.92781 1.80937 7.79434 1.76616L6.67101 1.40252ZM4.50619 7.83821L5.449 6.89534L7.33461 8.78101L11.1059 5.00978L12.0487 5.95258L7.33461 10.6666L4.50619 7.83821Z" fill="#13B05B"/>
                                                </svg>
                                                <svg x-show="! suggestion.passed" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M8.0026 14.6667C4.3207 14.6667 1.33594 11.6819 1.33594 8.00001C1.33594 4.31811 4.3207 1.33334 8.0026 1.33334C11.6845 1.33334 14.6693 4.31811 14.6693 8.00001C14.6693 11.6819 11.6845 14.6667 8.0026 14.6667ZM8.0026 7.05721L6.11698 5.17158L5.17418 6.11439L7.0598 8.00001L5.17418 9.88561L6.11698 10.8284L8.0026 8.94281L9.8882 10.8284L10.831 9.88561L8.9454 8.00001L10.831 6.11439L9.8882 5.17158L8.0026 7.05721Z" fill="#C22929"/>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="mt-1 text-sm text-dark-light2" x-text="`NASDAQ: ${suggestion.ticker}`"></div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </template>
            </div>
        </div>
    </template>
</div>